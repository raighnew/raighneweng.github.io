title: 计算机网络要点
toc: true
date: 2016-04-13 23:25:06
categories: Coding
thumbnail:
banner:
tags: [Coding, IT]
---
### OSI，TCP/IP，五层协议的体系结构，以及各层协议
OSI分层 （7层）：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。   
TCP/IP分层（4层）：网络接口层、 网际层、运输层、 应用层。   
五层协议     （5层）：物理层、数据链路层、网络层、运输层、 应用层。

<!--more-->

每一层的协议如下：   
物理层：RJ45、CLOCK、IEEE802.3    （中继器，集线器，网关）   
数据链路：PPP、FR、HDLC、VLAN、MAC  （网桥，交换机）   
网络层：IP、ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP、 （路由器）    
传输层：TCP、UDP、SPX    
会话层：NFS、SQL、NETBIOS、RPC    
表示层：JPEG、MPEG、ASII    
应用层：FTP、DNS、Telnet、SMTP、HTTP、WWW、NFS    
每一层的作用如下：    
物理层：通过媒介传输比特,确定机械及电气规范（比特Bit）    
数据链路层：将比特组装成帧和点到点的传递（帧Frame）    
网络层：负责数据包从源到宿的传递和网际互连（包PackeT）        
传输层：提供端到端的可靠报文传递和错误恢复（段Segment）  
会话层：建立、管理和终止会话（会话协议数据单元SPDU）  
表示层：对数据进行翻译、加密和压缩（表示协议数据单元PPDU）
应用层：允许访问OSI环境的手段（应用协议数据单元APDU）  
IP地址的分类  
A类地址：以0开头， 第一个字节范围：0~127（1.0.0.0 - 126.255.255.255）；  
B类地址：以10开头，    第一个字节范围：128~191（128.0.0.0 - 191.255.255.255）；  
C类地址：以110开头，  第一个字节范围：192~223（192.0.0.0 - 223.255.255.255）；  
10.0.0.0—10.255.255.255， 172.16.0.0—172.31.255.255， 192.168.0.0—192.168.255.255。（Internet上保留地址用于内部）  
IP地址与子网掩码相与得到主机号  

### ARP是地址解析协议，解释工作原理  
1：首先，每个主机都会在自己的ARP缓冲区中建立一个ARP列表，以表示IP地址和MAC地址之间的对应关系。  
2：当源主机要发送数据时，首先检查ARP列表中是否有对应IP地址的目的主机的MAC地址，如果有，则直接发送数据，如果没有，就向本网段的所有主机发送ARP数据包，该数据包包括的内容有：源主机 IP地址，源主机MAC地址，目的主机的IP 地址。   
3：当本网络的所有主机收到该ARP数据包时，首先检查数据包中的IP地址是否是自己的IP地址，如果不是，则忽略该数据包，如果是，则首先从数据包中取出源主机的IP和MAC地址写入到ARP列表中，如果已经存在，则覆盖，然后将自己的MAC地址写入ARP响应   
包中，告诉源主机自己是它想要找的MAC地址。  
4：源主机收到ARP响应包后。将目的主机的IP和MAC地址写入ARP列表，并利用此信息发送数据。如果源主机一直没有收到ARP响应数据包，表示ARP查询失败。  

### TCP三次握手和四次挥手的全过程
三次握手：  
第一次握手：客户端发送syn包(syn=x)到服务器，并进入SYN_SEND状态，等待服务器确认；   
第二次握手：服务器收到syn包，必须确认客户的SYN（ack=x+1），同时自己也发送一个SYN包（syn=y），即SYN+ACK包，此时服务器进入SYN_RECV状态；  
第三次握手：客户端收到服务器的SYN＋ACK包，向服务器发送确认包ACK(ack=y+1)，此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。
握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。理想状态下，TCP连接一旦建立，在通信双方中的任何一方主动关闭连接之前，TCP 连接都将被一直保持下去。   

四次握手   
与建立连接的“三次握手”类似，断开一个TCP连接则需要“四次握手”。  
第一次挥手：主动关闭方发送一个FIN，用来关闭主动方到被动关闭方的数据传送，也就是主动关闭方告诉被动关闭方：我已经不   会再给你发数据了(当然，在fin包之前发送出去的数据，如果没有收到对应的ack确认报文，主动关闭方依然会重发这些数据)，但是，此时主动关闭方还可 以接受数据。  
第二次挥手：被动关闭方收到FIN包后，发送一个ACK给对方，确认序号为收到序号+1（与SYN相同，一个FIN占用一个序号）。  
第三次挥手：被动关闭方发送一个FIN，用来关闭被动关闭方到主动关闭方的数据传送，也就是告诉主动关闭方，我的数据也发送完了，不会再给你发数据了。  
第四次挥手：主动关闭方收到FIN后，发送一个ACK给被动关闭方，确认序号为收到序号+1，至此，完成四次挥手。  
